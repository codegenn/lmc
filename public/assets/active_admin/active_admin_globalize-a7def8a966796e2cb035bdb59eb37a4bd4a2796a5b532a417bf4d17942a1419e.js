(function(){$(function(){var e;return e=function(){var d,c;return c=function(e){return 0===e.find(".add-locale ul li:not(.hidden)").length?e.find(".add-locale").hide():e.find(".add-locale").show()},d=function(e,t){var a;return a=e.parents("ul").find('.add-locale li:has(a[href="'+e.attr("href")+'"])'),t?(e.addClass("hidden").show().removeClass("hidden"),a.hide().addClass("hidden")):(e.addClass("hidden").hide().addClass("hidden"),a.show().removeClass("hidden"))},$(".activeadmin-translations > ul").each(function(){var e,n,i,t,a,r,l,s;if(s=(i=$(this)).hasClass("locale-selector"),!i.data("ready")){if(i.data("ready",!0),r=$("li > a",this),n=s?$(this).siblings("div.field-translation"):$(this).siblings("fieldset"),r.click(function(e){var t;return t=$(this),r.not(t).removeClass("active"),t.addClass("active"),n.hide(),n.filter(t.attr("href")).show(),e.preventDefault()}),r.eq(0).click(),s)return;return l=[],r.not(".default").each(function(){return l.push($("<li></li>").append($(this).clone().removeClass("active")))}),(e=$('<li class="add-locale"><a href="#">+</a></li>')).append($("<ul></ul>").append(l)),e.find("ul a").click(function(e){var t,a;return a=$(this).attr("href"),t=r.filter('[href="'+a+'"]'),d(t,!0),t.click(),c(i),e.preventDefault()}),a=$('<span class="remove">x</span>').click(function(e){var t;return e.stopImmediatePropagation(),e.preventDefault(),t=$(this).parent(),d(t,!1),t.hasClass("active")&&r.not(".hidden").eq(0).click(),c(i)}),r.not(".default").append(a),i.append(e),r.each(function(){var e,t,a,i;return t=$(this),a=0<(e=n.filter(t.attr("href"))).find(".input.error").length,t.toggleClass("error",a),i=!0,t.hasClass("error")||t.hasClass("default")?i=!1:e.find("[name]").not('[type="hidden"]').each(function(){if($(this).val())return i=!1}),d(t,!i)}),(t=i.parents("form")).data("ready")||(t.data("ready"),t.submit(function(){return $(".activeadmin-translations > ul").each(function(){var a;return a=$(this).siblings("fieldset"),$("li:not(.add-locale) > a",this).each(function(){var e,t;if($(this).hasClass("hidden"))return e=$("fieldset"+$(this).attr("href")),(t=$("input[id$=_id]",e)).val()?$("<input/>").attr({type:"hidden",name:t.attr("name").replace("[id]","[_destroy]"),id:t.attr("id").replace("_id","_destroy"),value:"1"}).appendTo(e):a.filter($(this).attr("href")).remove()})})})),c(i),r.filter(".default").click()}})},$("a").bind("click",function(){return setTimeout(function(){return e()},50)}),$("a.ui-translation-trigger").click(function(e){var t,a;return t=$(this).data("locale"),a=$(this).closest("td"),$(".field-translation",a).hide(),$(".locale-"+t,a).show(),$(this).parent().children("a.ui-translation-trigger").removeClass("active"),$(this).addClass("active"),e.preventDefault()}),e()})}).call(this);