= form_for(@cart, method: :put) do |f|
  .wrap-table-shopping-cart
    %table.table-shopping-cart
      %tr.table_head
        %th.column-1
          = I18n.t("page.cart.product")
        %th.column-2
        %th.column-3
          = I18n.t("page.cart.price")
        %th.column-4
          = I18n.t("page.cart.quantity")
        %th.column-5
          = I18n.t("page.cart.total")
      - @cart.line_items.includes(:stock).each do |line_item|
        %tr.table_row
          %td.column-1
            = link_to line_item, method: :delete, noindex: true, id: 'delete', data: { confirm: 'Are you sure you want to delete this line item?' }, class: 'delete-item' do
              .how-itemcart1
                =# cl_image_tag line_item.stock.product.product_images.first.url ? line_item.stock.product.product_images.first.url : line_item.stock.product.product_images.first.pimage
          %td.column-2
            = line_item.stock.product.title
          %td.column-3
            - if line_item.stock.product.promotion_price.present?
              .promotion-price
                = "#{number_with_delimiter(line_item.stock.product.price.to_i, :delimiter => '.')} vnd"
              %b
                = "#{number_with_delimiter(line_item.stock.product.promotion_price.to_i, :delimiter => '.')} vnd"
            - else
              = "#{number_with_delimiter(line_item.stock.product.price.to_i, :delimiter => '.')} vnd"
          %td.column-4
            = f.fields_for :line_items, line_item do |line|
              .wrap-num-product.flex-w.m-l-auto.m-r-0
                .btn-num-product-down.cl8.hov-btn3.trans-04.flex-c-m
                  %i.fs-16.zmdi.zmdi-minus
              = line.text_field :quantity, class: 'mtext-104 cl3 txt-center num-product'
              .btn-num-product-up.cl8.hov-btn3.trans-04.flex-c-m
                %i.fs-16.zmdi.zmdi-plus
          %td.column-5
            = "#{number_with_delimiter(line_item.total_price.to_i, :delimiter => '.')} VND"
      %tr.table_row
        %td.column-1.column-voucher
          = f.label :voucher_code, I18n.t("page.cart.voucher"), class: 'control-label'
        %td.column-3{:colspan => "2"}
          = f.text_field :voucher_code, autofocus: true, class: 'stext-111 cl2 plh3 size-100 input-txt'
  .flex-w.flex-sb-m.bor15.p-t-18.p-b-15.p-lr-40.p-lr-15-sm
    .flex-w.flex-m.m-r-20.m-tb-5
    = f.hidden_field :id, { :value => @cart.code }
    = submit_tag I18n.t("page.cart.update_cart"), class: 'flex-c-m stext-101 cl2 size-119 bg8 bor13 hov-btn3 p-lr-15 trans-04 pointer m-tb-10'